zerops:
  - setup: nginx
    build:
      base: go@1
      buildCommands:
        - go build -o main backend/main.go
      deploy:
        - main
        - nginx/nginx.conf
        - nginx/default
    run:
      prepareCommands:
        - apt update && apt -y install nginx
      initCommands:
        - rm /etc/nginx/sites-enabled/default
        - rm /etc/nginx/nginx.conf
        - ln -s nginx/nginx.conf /etc/nginx/nginx.conf
        - ln -s nginx/default /etc/nginx/sites-enabled/default
        - service nginx restart
      start: ./main
  - setup: backend
    build:
      base: go@1
      buildCommands:
        - go build -o main backend/main.go
      deploy:
        - main
    run:
      start: ./main
  - setup: test2
    build:
      base: go@1
      buildCommands:
        - zsc noop
        - go build -o main server/main.go
      deploy:
        - main
    run:
      start: ./main
  - setup: apibuild
    build:
      base: go@1
      buildCommands:
        - go build -o main server/main.go
      deploy:
        - main
    run:
      start: ./main

  - setup: api
    run:
      start: zsc noop 


